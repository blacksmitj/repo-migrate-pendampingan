generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model activity_logs {
  id            String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id       String?   @db.Uuid
  activity      String
  original_data Json?
  final_data    Json?
  description   String?
  created_at    DateTime? @default(now()) @db.Timestamptz(6)
  users         users?    @relation(fields: [user_id], references: [id], onUpdate: NoAction)
}

model addresses {
  id               String     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id       String?    @db.Uuid
  label            String?    @db.VarChar(255)
  province_id      String?    @db.VarChar(2)
  regency_id       String?    @db.VarChar(4)
  district_id      String?    @db.VarChar(6)
  village_id       String?    @db.VarChar(10)
  province_name    String?    @db.VarChar(255)
  regency_name     String?    @db.VarChar(255)
  district_name    String?    @db.VarChar(255)
  village_name     String?    @db.VarChar(255)
  address_line     String?
  postal_code      String?    @db.VarChar(10)
  longitude        Decimal?   @db.Decimal(11, 8)
  latitude         Decimal?   @db.Decimal(11, 8)
  google_maps_link String?
  created_at       DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?  @default(now()) @db.Timestamptz(6)
  districts        districts? @relation(fields: [district_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profiles         profiles?  @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  provinces        provinces? @relation(fields: [province_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  regencies        regencies? @relation(fields: [regency_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  villages         villages?  @relation(fields: [village_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model batches {
  id           String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  code         String?        @unique @db.VarChar(50)
  start_date   DateTime?      @db.Date
  created_at   DateTime?      @default(now()) @db.Timestamptz(6)
  participants participants[]
}

model business_documents {
  document_id String      @id @db.Uuid
  business_id String?     @db.Uuid
  businesses  businesses? @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  documents   documents   @relation(fields: [document_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([business_id])
}

model business_employees {
  id                String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id       String?     @db.Uuid
  name              String?     @db.VarChar(255)
  nik               String?     @db.VarChar(32)
  gender            String?     @db.VarChar(2)
  role              String?     @db.VarChar(100)
  employment_status String?     @db.VarChar(50)
  bpjs_status       String?     @db.VarChar(50)
  bpjs_number       String?     @db.VarChar(50)
  bpjs_type         String?     @db.VarChar(50)
  disability        Boolean?    @default(false)
  disability_type   String?     @db.VarChar(255)
  is_active         Boolean?    @default(true)
  created_at        DateTime?   @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?   @default(now()) @db.Timestamptz(6)
  legacy_id         BigInt?
  businesses        businesses? @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model businesses {
  id                  String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  participant_id      String?              @db.Uuid
  legacy_tkm_id       String?              @db.VarChar(100)
  name                String?              @db.VarChar(255)
  sector              String?              @db.VarChar(100)
  type                String?              @db.VarChar(100)
  description         String?
  main_product        String?              @db.VarChar(200)
  location_ownership  String?              @db.VarChar(100)
  nib_number          String?              @db.VarChar(50)
  marketing_channels  String?
  marketing_areas     String?
  marketing_countries String?
  detailed_location   String?
  partner_name        String?              @db.VarChar(200)
  partner_count       Int?
  revenue_per_period  Decimal?             @db.Decimal(15, 2)
  profit_per_period   Decimal?             @db.Decimal(15, 2)
  production_volume   Int?
  production_unit     String?              @db.VarChar(50)
  created_at          DateTime?            @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?            @default(now()) @db.Timestamptz(6)
  business_documents  business_documents[]
  business_employees  business_employees[]
  participants        participants?        @relation(fields: [participant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([legacy_tkm_id], map: "idx_businesses_tkm")
}

model districts {
  id         String      @id @db.VarChar(6)
  regency_id String      @db.VarChar(4)
  name       String      @db.VarChar(255)
  addresses  addresses[]
  regencies  regencies   @relation(fields: [regency_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  villages   villages[]
}

model documents {
  id                       String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  entity_id                String                    @db.Uuid
  entity_type              String                    @db.VarChar(50)
  label                    String                    @db.VarChar(255)
  file_url                 String
  file_type                String?                   @db.VarChar(50)
  metadata                 Json?
  created_at               DateTime?                 @default(now()) @db.Timestamptz(6)
  business_documents       business_documents?
  logbook_documents        logbook_documents?
  monthly_report_documents monthly_report_documents?
  participant_documents    participant_documents?
  upload_report_documents  upload_report_documents?
}

model emergency_contacts {
  id             String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  participant_id String?       @db.Uuid
  legacy_tkm_id  String?       @db.VarChar(100)
  full_name      String?       @db.VarChar(255)
  phone_number   String?       @db.VarChar(20)
  relationship   String?       @db.VarChar(100)
  priority       Int?          @default(1)
  created_at     DateTime?     @default(now()) @db.Timestamptz(6)
  participants   participants? @relation(fields: [participant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([legacy_tkm_id], map: "idx_emergency_contacts_tkm")
}

model logbook_documents {
  document_id String    @id @db.Uuid
  logbook_id  String?   @db.Uuid
  documents   documents @relation(fields: [document_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  logbooks    logbooks? @relation(fields: [logbook_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([logbook_id])
}

model logbooks {
  id                 String              @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  mentor_id          String?             @db.Uuid
  participant_id     String?             @db.Uuid
  legacy_tkm_id      String?             @db.VarChar(100)
  activity_date      DateTime            @db.Date
  start_time         DateTime?           @db.Time(6)
  end_time           DateTime?           @db.Time(6)
  meeting_type       String?             @db.VarChar(100)
  visit_type         String?             @db.VarChar(100)
  delivery_method    String?             @db.VarChar(100)
  mentoring_material String?
  activity_summary   String?
  obstacles          String?
  solutions          String?
  is_verified        String?             @default("pending") @db.VarChar(25)
  verification_note  String?
  expense_amount     Decimal?            @db.Decimal(12, 2)
  no_expense_reason  String?
  created_at         DateTime?           @default(now()) @db.Timestamptz(6)
  updated_at         DateTime?           @default(now()) @db.Timestamptz(6)
  logbook_documents  logbook_documents[]
  mentors            mentors?            @relation(fields: [mentor_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  participants       participants?       @relation(fields: [participant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([legacy_tkm_id], map: "idx_logbooks_tkm")
}

model mentor_participants {
  id                String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  mentor_id         String?       @db.Uuid
  participant_id    String?       @db.Uuid
  legacy_tkm_id     String?       @db.VarChar(100)
  assignment_status String?       @default("active") @db.VarChar(50)
  batch_year        Int?
  created_at        DateTime?     @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?     @default(now()) @db.Timestamptz(6)
  mentors           mentors?      @relation(fields: [mentor_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  participants      participants? @relation(fields: [participant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([mentor_id, participant_id])
  @@index([legacy_tkm_id], map: "idx_mentor_participants_tkm")
}

model mentors {
  id                  String                @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id             String?               @unique @db.Uuid
  legacy_id           BigInt?
  specialization      String?               @db.VarChar(255)
  created_at          DateTime?             @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?             @default(now()) @db.Timestamptz(6)
  logbooks            logbooks[]
  mentor_participants mentor_participants[]
  users               users?                @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  monthly_reports     monthly_reports[]
}

model monthly_report_documents {
  document_id       String           @id @db.Uuid
  monthly_report_id String?          @db.Uuid
  documents         documents        @relation(fields: [document_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  monthly_reports   monthly_reports? @relation(fields: [monthly_report_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([monthly_report_id], map: "monthly_report_documents_report_id_idx")
}

model monthly_reports {
  id                           String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  participant_id               String?                    @db.Uuid
  mentor_id                    String?                    @db.Uuid
  legacy_tkm_id                String?                    @db.VarChar(100)
  report_month                 Int
  report_year                  Int
  bookkeeping_cashflow         Boolean?                   @default(false)
  bookkeeping_income_statement Boolean?                   @default(false)
  sales_volume                 Int?
  sales_unit                   String?                    @db.VarChar(50)
  production_capacity          Int?
  production_unit              String?                    @db.VarChar(50)
  marketing_area               String?
  revenue                      Decimal?                   @db.Decimal(15, 2)
  business_condition           String?
  obstacles                    String?
  note_confirmation            String?                    @db.VarChar(255)
  lpj_status                   Boolean?                   @default(false)
  is_verified                  String?                    @default("pending") @db.VarChar(25)
  verification_note            String?
  created_at                   DateTime?                  @default(now()) @db.Timestamptz(6)
  updated_at                   DateTime?                  @default(now()) @db.Timestamptz(6)
  monthly_report_documents     monthly_report_documents[]
  mentors                      mentors?                   @relation(fields: [mentor_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  participants                 participants?              @relation(fields: [participant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([legacy_tkm_id], map: "idx_monthly_reports_tkm")
}

model participant_documents {
  document_id    String        @id @db.Uuid
  participant_id String?       @db.Uuid
  documents      documents     @relation(fields: [document_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  participants   participants? @relation(fields: [participant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([participant_id])
}

model participant_groups {
  id            String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  legacy_tkm_id String?        @db.VarChar(50)
  name          String?        @db.VarChar(255)
  created_at    DateTime?      @default(now()) @db.Timestamptz(6)
  participants  participants[]
}

model participants {
  id                     String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id             String?                 @db.Uuid
  batch_id               String?                 @db.Uuid
  group_id               String?                 @db.Uuid
  legacy_tkm_id          String?                 @unique @db.VarChar(100)
  status                 String?                 @db.VarChar(50)
  last_education         String?                 @db.VarChar(100)
  disability_status      Boolean?                @default(false)
  disability_type        String?                 @db.VarChar(150)
  current_activity       String?
  communication_status   String?                 @db.VarChar(255)
  fund_disbursement      String?                 @db.VarChar(255)
  presence_status        String?                 @db.VarChar(255)
  willing_to_be_assisted String?                 @db.VarChar(255)
  reason_not_willing     String?
  status_applicant       String?                 @db.VarChar(255)
  reason_drop            String?
  submission_status      String?                 @db.VarChar(50)
  submission_date        DateTime?               @db.Timestamptz(6)
  registration_date      DateTime?               @db.Timestamptz(6)
  id_pendaftar           String?                 @db.VarChar(100)
  link_detail_tkm        String?
  created_at             DateTime?               @default(now()) @db.Timestamptz(6)
  updated_at             DateTime?               @default(now()) @db.Timestamptz(6)
  businesses             businesses[]
  emergency_contacts     emergency_contacts[]
  logbooks               logbooks[]
  mentor_participants    mentor_participants[]
  monthly_reports        monthly_reports[]
  participant_documents  participant_documents[]
  batches                batches?                @relation(fields: [batch_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  participant_groups     participant_groups?     @relation(fields: [group_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profiles               profiles?               @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([legacy_tkm_id], map: "idx_participants_tkm")
}

model universities {
  id         String     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name       String     @db.VarChar(255)
  address    String?
  city       String?    @db.VarChar(100)
  province   String?    @db.VarChar(100)
  created_at DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at DateTime?  @default(now()) @db.Timestamptz(6)
  legacy_id  Int?       @unique
  profiles   profiles[]
}

model profiles {
  id                String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id           String?        @unique @db.Uuid
  university_id     String?        @db.Uuid
  full_name         String?        @db.VarChar(255)
  id_number         String?        @db.VarChar(20)
  whatsapp_number   String?        @db.VarChar(20)
  kk_number         String?        @db.VarChar(25)
  age               Int?
  social_media_type String?        @db.VarChar(50)
  social_media_name String?        @db.VarChar(100)
  social_media_link String?
  gender            String?        @db.VarChar(10)
  avatar_url        String?
  pob               String?        @db.VarChar(255)
  dob               DateTime?      @db.Date
  created_at        DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?      @default(now()) @db.Timestamptz(6)
  legacy_id         BigInt?
  addresses         addresses[]
  participants      participants[]
  users             users?         @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  universities      universities?  @relation(fields: [university_id], references: [id], onDelete: SetNull, onUpdate: NoAction)
}

model provinces {
  id        String      @id @db.VarChar(2)
  name      String      @db.VarChar(255)
  addresses addresses[]
  regencies regencies[]
}

model regencies {
  id          String      @id @db.VarChar(4)
  province_id String      @db.VarChar(2)
  name        String      @db.VarChar(255)
  type        String?     @db.VarChar(50)
  addresses   addresses[]
  districts   districts[]
  provinces   provinces   @relation(fields: [province_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model roles {
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name       String    @unique @db.VarChar(255)
  guard_name String    @db.VarChar(255)
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @db.Timestamptz(6)
  users      users[]
}

model upload_report_documents {
  document_id      String          @id @db.Uuid
  upload_report_id String?         @db.Uuid
  documents        documents       @relation(fields: [document_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  upload_reports   upload_reports? @relation(fields: [upload_report_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([upload_report_id], map: "upload_report_documents_report_id_idx")
}

model upload_reports {
  id                      String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  admin_user_id           String?                   @db.Uuid
  note                    String?
  verified                Boolean?                  @default(false)
  created_at              DateTime?                 @default(now()) @db.Timestamptz(6)
  updated_at              DateTime?                 @default(now()) @db.Timestamptz(6)
  legacy_id               BigInt?
  upload_report_documents upload_report_documents[]
  users                   users?                    @relation(fields: [admin_user_id], references: [id], onUpdate: NoAction)
}

model users {
  id                String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  role_id           String?          @db.Uuid
  username          String?          @unique @db.VarChar(255)
  email             String           @unique @db.VarChar(255)
  password          String
  email_verified_at DateTime?        @db.Timestamptz(6)
  remember_token    String?          @db.VarChar(100)
  created_at        DateTime?        @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?        @default(now()) @db.Timestamptz(6)
  legacy_id         BigInt?
  activity_logs     activity_logs[]
  mentors           mentors?
  profiles          profiles?
  upload_reports    upload_reports[]
  roles             roles?           @relation(fields: [role_id], references: [id], onUpdate: NoAction)
}

model villages {
  id          String      @id @db.VarChar(10)
  district_id String      @db.VarChar(6)
  name        String      @db.VarChar(255)
  addresses   addresses[]
  districts   districts   @relation(fields: [district_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}
